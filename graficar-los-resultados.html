<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Análisis multivariante de la comunidad</title>
  <meta name="description" content="Este documento presenta una introducción al análisis multivariante de comunidades bióticas.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Análisis multivariante de la comunidad" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este documento presenta una introducción al análisis multivariante de comunidades bióticas." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Análisis multivariante de la comunidad" />
  
  <meta name="twitter:description" content="Este documento presenta una introducción al análisis multivariante de comunidades bióticas." />
  

<meta name="author" content="Carlos Iván Espinosa">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="ordenaciones.html">
<link rel="next" href="bibliografia.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #0000ff; } /* Keyword */
code > span.ch { color: #008080; } /* Char */
code > span.st { color: #008080; } /* String */
code > span.co { color: #008000; } /* Comment */
code > span.ot { color: #ff4000; } /* Other */
code > span.al { color: #ff0000; } /* Alert */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #008000; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #008080; } /* SpecialChar */
code > span.vs { color: #008080; } /* VerbatimString */
code > span.ss { color: #008080; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #0000ff; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ff4000; } /* Preprocessor */
code > span.do { color: #008000; } /* Documentation */
code > span.an { color: #008000; } /* Annotation */
code > span.cv { color: #008000; } /* CommentVar */
code > span.at { } /* Attribute */
code > span.in { color: #008000; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href=" ">Análisis multivariante de la comunidad</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="chapter" data-level="" data-path="objetivos.html"><a href="objetivos.html"><i class="fa fa-check"></i>Objetivos</a></li>
<li class="chapter" data-level="1" data-path="analisis-multivariado-de-la-composicion-de-la-comunidad.html"><a href="analisis-multivariado-de-la-composicion-de-la-comunidad.html"><i class="fa fa-check"></i><b>1</b> Análisis multivariado de la composición de la comunidad</a><ul>
<li class="chapter" data-level="1.1" data-path="analisis-multivariado-de-la-composicion-de-la-comunidad.html"><a href="analisis-multivariado-de-la-composicion-de-la-comunidad.html#agrupamiento-jerarquico-hierarchic-cluster"><i class="fa fa-check"></i><b>1.1</b> Agrupamiento Jerárquico (Hierarchic Cluster)</a></li>
<li class="chapter" data-level="1.2" data-path="analisis-multivariado-de-la-composicion-de-la-comunidad.html"><a href="analisis-multivariado-de-la-composicion-de-la-comunidad.html#interpretando-el-cluster"><i class="fa fa-check"></i><b>1.2</b> Interpretando el cluster</a><ul>
<li class="chapter" data-level="1.2.1" data-path="analisis-multivariado-de-la-composicion-de-la-comunidad.html"><a href="analisis-multivariado-de-la-composicion-de-la-comunidad.html#elegir-la-funcion-de-enlace"><i class="fa fa-check"></i><b>1.2.1</b> Elegir la función de enlace</a></li>
<li class="chapter" data-level="1.2.2" data-path="analisis-multivariado-de-la-composicion-de-la-comunidad.html"><a href="analisis-multivariado-de-la-composicion-de-la-comunidad.html#elegir-el-punto-de-corte"><i class="fa fa-check"></i><b>1.2.2</b> Elegir el punto de corte</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="analisis-multivariado-de-la-composicion-de-la-comunidad.html"><a href="analisis-multivariado-de-la-composicion-de-la-comunidad.html#anosimincluir"><i class="fa fa-check"></i><b>1.3</b> ANOSIM…Incluir</a></li>
<li class="chapter" data-level="1.4" data-path="analisis-multivariado-de-la-composicion-de-la-comunidad.html"><a href="analisis-multivariado-de-la-composicion-de-la-comunidad.html#ejercicio-2-analisis-de-clasificacion"><i class="fa fa-check"></i><b>1.4</b> Ejercicio 2: Análisis de clasificación</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ordenaciones.html"><a href="ordenaciones.html"><i class="fa fa-check"></i><b>2</b> Ordenaciones</a><ul>
<li class="chapter" data-level="2.1" data-path="ordenaciones.html"><a href="ordenaciones.html#pasos-previos-a-la-ordenacion"><i class="fa fa-check"></i><b>2.1</b> Pasos previos a la Ordenación</a></li>
<li class="chapter" data-level="2.2" data-path="ordenaciones.html"><a href="ordenaciones.html#ordenacion-indirecta-o-no-constrenida"><i class="fa fa-check"></i><b>2.2</b> Ordenación indirecta o no constreñida</a><ul>
<li class="chapter" data-level="2.2.1" data-path="ordenaciones.html"><a href="ordenaciones.html#metodos-de-ordenacion."><i class="fa fa-check"></i><b>2.2.1</b> Métodos de ordenación.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="graficar-los-resultados.html"><a href="graficar-los-resultados.html"><i class="fa fa-check"></i><b>3</b> Graficar los resultados</a><ul>
<li class="chapter" data-level="3.0.1" data-path="graficar-los-resultados.html"><a href="graficar-los-resultados.html#interpretacion-ambiental"><i class="fa fa-check"></i><b>3.0.1</b> Interpretación ambiental</a></li>
<li class="chapter" data-level="3.0.2" data-path="graficar-los-resultados.html"><a href="graficar-los-resultados.html#ejercicio"><i class="fa fa-check"></i><b>3.0.2</b> Ejercicio</a></li>
<li class="chapter" data-level="3.1" data-path="graficar-los-resultados.html"><a href="graficar-los-resultados.html#ordenaciones-directas-o-constrenidas"><i class="fa fa-check"></i><b>3.1</b> Ordenaciones directas o constreñidas</a></li>
<li class="chapter" data-level="3.2" data-path="graficar-los-resultados.html"><a href="graficar-los-resultados.html#realizando-una-ordenacion-constrenida"><i class="fa fa-check"></i><b>3.2</b> Realizando una ordenación constreñida</a></li>
<li class="chapter" data-level="3.3" data-path="graficar-los-resultados.html"><a href="graficar-los-resultados.html#ejercicio-3-analisis-de-ordenacion"><i class="fa fa-check"></i><b>3.3</b> Ejercicio 3: Análisis de Ordenación</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliografia.html"><a href="bibliografia.html"><i class="fa fa-check"></i>Bibliografia</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análisis multivariante de la comunidad</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graficar-los-resultados" class="section level1">
<h1><span class="header-section-number">Capítulo 3</span> Graficar los resultados</h1>
<p>Como hemos visto existen diferentes formas de graficar los resultados de la ordenación. A continuación mostramos una forma de personalización del gráfico de ordenación que se aplica a la mayor parte de ordenaciones.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(nmds.dune, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>)  <span class="co"># para dibujar un plot vacío</span>
<span class="kw">points</span>(nmds.dune, <span class="dt">display=</span><span class="st">&quot;sites&quot;</span>, <span class="dt">cex=</span><span class="fl">0.8</span>, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;yellow&quot;</span>)  
<span class="kw">text</span>(nmds.dune, <span class="dt">display=</span> <span class="st">&quot;spec&quot;</span>, <span class="dt">cex=</span><span class="fl">0.5</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plotnmds"></span>
<img src="AnalisisMultivarianteComunidad_files/figure-html/plotnmds-1.png" alt="Representación gráfica del NMDS" width="432" />
<p class="caption">
Figure 3.1: Representación gráfica del NMDS
</p>
</div>
<p>Podemos ver en la figura <a href="graficar-los-resultados.html#fig:plotnmds">3.1</a> que ciertas especies están asociadas con ciertas localidades esto nos podría servir para explorar los datos.</p>
<div id="interpretacion-ambiental" class="section level3">
<h3><span class="header-section-number">3.0.1</span> Interpretación ambiental</h3>
<p>Como lo mencionamos previamente las ordenaciones indirectas no sirven para testar hipótesis, este método nos permite organizar nuestras variables en un espacio dimensional más reducido. Sin embargo, podríamos usar estos ejes y relacionarlos con variables ambientales. Vamos a usar el paquete vegan para ajustar un modelo que permita evaluar el efecto de las variables ambientales a la ordenación.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(varechem)
<span class="kw">data</span>(varespec)
vare.mds &lt;-<span class="st"> </span><span class="kw">metaMDS</span>(varespec, <span class="dt">trace =</span> <span class="ot">FALSE</span>)
ef &lt;-<span class="st"> </span><span class="kw">envfit</span>(vare.mds, varechem, <span class="dt">permu =</span> <span class="dv">999</span>)
ef</code></pre></div>
<pre><code>## 
## ***VECTORS
## 
##             NMDS1    NMDS2     r2 Pr(&gt;r)    
## N        -0.05733 -0.99836 0.2536  0.049 *  
## P         0.61971  0.78483 0.1938  0.091 .  
## K         0.76644  0.64231 0.1809  0.125    
## Ca        0.68520  0.72836 0.4119  0.004 ** 
## Mg        0.63252  0.77454 0.4270  0.003 ** 
## S         0.19139  0.98151 0.1752  0.145    
## Al       -0.87161  0.49021 0.5269  0.001 ***
## Fe       -0.93601  0.35197 0.4451  0.003 ** 
## Mn        0.79874 -0.60167 0.5231  0.001 ***
## Zn        0.61754  0.78654 0.1879  0.104    
## Mo       -0.90311  0.42942 0.0609  0.518    
## Baresoil  0.92488 -0.38025 0.2508  0.063 .  
## Humdepth  0.93284 -0.36028 0.5201  0.001 ***
## pH       -0.64803  0.76162 0.2308  0.072 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## Permutation: free
## Number of permutations: 999</code></pre>
<p>Ahora podemos ver las variables que son significativas para explicar la ordenación de los datos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vare.mds, <span class="dt">display =</span> <span class="st">&quot;sites&quot;</span>)
<span class="kw">plot</span>(ef, <span class="dt">p.max =</span> <span class="fl">0.05</span>)</code></pre></div>
<p><img src="AnalisisMultivarianteComunidad_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Con variables categóricas podríamos hacer el mismo procedimiento pero tener una grafica de salida un poco diferente.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ef &lt;-<span class="st"> </span><span class="kw">envfit</span>(ca.dune, dune.env, <span class="dt">permutations =</span> <span class="dv">999</span>)
ef</code></pre></div>
<pre><code>## 
## ***VECTORS
## 
##         CA1      CA2     r2 Pr(&gt;r)  
## A1 0.998160 0.060614 0.3104  0.041 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## Permutation: free
## Number of permutations: 999
## 
## ***FACTORS:
## 
## Centroids:
##                  CA1     CA2
## Moisture1    -0.7484 -0.1423
## Moisture2    -0.4652 -0.2156
## Moisture4     0.1827 -0.7315
## Moisture5     1.1143  0.5708
## ManagementBF -0.7258 -0.1413
## ManagementHF -0.3867 -0.2960
## ManagementNM  0.6517  1.4405
## ManagementSF  0.3376 -0.6761
## UseHayfield  -0.2861  0.6488
## UseHaypastu  -0.0735 -0.5602
## UsePasture    0.5163  0.0508
## Manure0       0.6517  1.4405
## Manure1      -0.4639 -0.1738
## Manure2      -0.5872 -0.3600
## Manure3       0.5187 -0.3172
## Manure4      -0.2059 -0.8775
## 
## Goodness of fit:
##                r2 Pr(&gt;r)   
## Moisture   0.4113  0.005 **
## Management 0.4441  0.003 **
## Use        0.1845  0.099 . 
## Manure     0.4552  0.007 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## Permutation: free
## Number of permutations: 999</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(ca.dune, <span class="dt">display =</span> <span class="st">&quot;sites&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>)
<span class="kw">with</span>(dune.env, <span class="kw">ordiellipse</span>(ca.dune, Management, <span class="dt">kind =</span> <span class="st">&quot;se&quot;</span>, <span class="dt">conf =</span> <span class="fl">0.95</span>, <span class="dt">label=</span> <span class="ot">TRUE</span>))</code></pre></div>
<p><img src="AnalisisMultivarianteComunidad_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="ejercicio" class="section level3">
<h3><span class="header-section-number">3.0.2</span> Ejercicio</h3>
<p>Los datos que se presentan <a href="%22https://github.com/Ciespinosa/AnalisisMultivariante/TraitsVege.csv%22">aquí</a> corresponden a rasgos asociados a procesos de dispersión de semillas, incluyendo los potenciales grupos de dispersores. Colectamos información de 10 rasgos de frutos y semillas de 71 especies leñosas. Se registraron seis rasgos de frutos; tipo, color, peso, largo, ancho y número de semillas. Para semillas se registraron tres rasgos; peso, longitud y ancho. Adicionalmente se asignó un síndrome de dispersión a cada especie.</p>
<p>Los rasgos de frutos y semillas colectados en este trabajo, han sido asociados con la habilidad de las plantas para lidiar con el estrés. Muller-Landau (2010) sugiere que las especies con semillas pequeñas tienen una ventaja en fertilidad y dispersión, por producir más semillas y facilitar su desplazamiento a grandes distancias. Por otro lado, las semillas grandes tienen la ventaja tolerancia al estrés, porque estas proveen energía y material para el crecimiento de las plántulas. Una mayor contribución de nutrientes en semillas grandes facilita la sobrevivencia bajo ambientes más estresantes, ya sea por sombra, humedad, herbivoría o perturbaciones.</p>
<p>En este contexto, esperamos que los ambientes menos estresantes estén dominados por especies con semillas pequeñas, pero un amplio rango de tamaños de semillas. En ambientes de mayor estrés, se espera encontrar un subconjunto de especies con semillas grandes y baja capacidad de dispersión.</p>
<p>Para analizar el impacto del disturbio sobre la estructura de la comunidad en términos de rasgos funcionales usaremos tres variables que han mostrado ser un subrogado de perturbaciones antrópicas; (1) distancia al centro poblado más cercano, (2) peso de excretas de ganado, (3) número de árboles con DBH &gt; 20 cm, donde un bajo número de árboles grandes implica una alta perturbación. Puede obtener los datos de <a href="%22https://github.com/Ciespinosa/AnalisisMultivariante/Parcelas.csv%22">aquí</a></p>
<p>Vamos a analizar por separado los rasgos cualitativos y los cuantitativos.</p>
<p>Para analizar los efectos de la perturbación sobre los rasgos cualitativos de los frutos vamos a ajustar un PCA para cada rasgo; tipo de fruto, síndrome de dispersión y color del fruto. Utilizaremos la matriz de datos morfológicos cualitativos. Realizamos un modelo lineal usando el primer eje del PCA como variable de respuesta y cada una de las tres variables de perturbación como variables explicativas. Usaremos la función “rda” del paquete “vegan” para ajustar el PCA, y la función “lm” del paquete “stats” para el modelo lineal.</p>

</div>
<div id="ordenaciones-directas-o-constrenidas" class="section level2">
<h2><span class="header-section-number">3.1</span> Ordenaciones directas o constreñidas</h2>
<p>Si bien las técnicas de ordenación indirecta nos permiten descubrir ciertos patrones, no nos permite testar hipótesis y ver las relaciones de esta matriz con otras variables.</p>
<p>Si disponemos de una matriz de variables explicativas es posible utilizar análisis de ordenación constreñidos. De esta forma, esta matriz representa la información que tenemos sobre cada una de las muestras y podemos usarla para predecir los valores de las variables respuesta (la composición de especies).</p>
<p>Al igual que para los análisis de ordenaciones no constreñidas el tipo de ordenación depende de la respuesta que tenemos en las variables (Tabla <a href="graficar-los-resultados.html#tab:ordenacion1">3.1</a> )</p>
<table>
<caption><span id="tab:ordenacion1">Table 3.1: </span>Relación entre el tipo de variable y el método de ordenación a utilizar</caption>
<thead>
<tr class="header">
<th align="left">Medidas.de.Similitud</th>
<th align="left">Tipo.de.Ordenación</th>
<th align="left">Tipo.Ordenación.Constreñida</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Respuesta lineal</td>
<td align="left">PCA</td>
<td align="left">RDA (Redundancy Analysis)</td>
</tr>
<tr class="even">
<td align="left">Respuesta Unimodal</td>
<td align="left">CA/DCA</td>
<td align="left">CCA (Canonical Correspondence Analysis)</td>
</tr>
<tr class="odd">
<td align="left">Bray-Curtis</td>
<td align="left">PcoA/mMDS/nmMDS</td>
<td align="left">PERMANOVA</td>
</tr>
</tbody>
</table>
<p>Una interesante propiedad de los análisis de ordenación constreñidos es que puedo hacer una ordenación parcial. Esta propiedad me permite evaluar como un grupo de variables pueden influir en mi matriz de respuesta. Podría dividir la información, por ejemplo, en variables ambientales y variables bióticas y ver cuánto explica cada una y cuanto explican en conjunto.</p>
</div>
<div id="realizando-una-ordenacion-constrenida" class="section level2">
<h2><span class="header-section-number">3.2</span> Realizando una ordenación constreñida</h2>
<p>Al igual que en el caso de la ordenación no constreñida debemos decidir el tipo de ordenación constreñida que vamos hacer. En el caso de los datos de <em>Dune</em> sabemos que la respuesta es unimodal por lo que escogeremos un análisis canónico de correspondencias (CCA) para nuestra ordenación constreñida.</p>
<p>Para hacer la ordenación constreñida necesitamos una matriz con variables explicativas, utilizaremos las variables provistas en el paquete vegan denominadas env.env.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;dune.env&quot;</span>) <span class="co">#Llamamos a los datos</span>

ord.cca &lt;-<span class="st"> </span><span class="kw">cca</span>(dune~<span class="st"> </span>A1 +<span class="st"> </span>Use, <span class="dt">data=</span>dune.env)
ord.cca</code></pre></div>
<pre><code>## Call: cca(formula = dune ~ A1 + Use, data = dune.env)
## 
##               Inertia Proportion Rank
## Total          2.1153     1.0000     
## Constrained    0.4724     0.2233    3
## Unconstrained  1.6429     0.7767   16
## Inertia is scaled Chi-square 
## 
## Eigenvalues for constrained axes:
##    CCA1    CCA2    CCA3 
## 0.27630 0.14929 0.04683 
## 
## Eigenvalues for unconstrained axes:
##    CA1    CA2    CA3    CA4    CA5    CA6    CA7    CA8    CA9   CA10 
## 0.3792 0.3091 0.2093 0.1629 0.1308 0.0965 0.0758 0.0731 0.0483 0.0456 
##   CA11   CA12   CA13   CA14   CA15   CA16 
## 0.0431 0.0237 0.0163 0.0141 0.0108 0.0042</code></pre>
<p>Lo que podemos ver es que la variable A1 más Use explican el 22.33% de la variación en los datos.</p>
<p>La decisión de que modelos deberían generar debe responder a una lógica ecológica, así podemos probar como algunas variables juegan o no un rol en la estructura de la comunidad.</p>
<p>Una herramienta que podríamos utilizar para analizar la importancia de cada variable es utilizar la función <code>envfit</code>, esta función permite relacionar la ordenación no constreñida con las variables explicativas y mediante un test de permutación mostrarnos que variables se asocian significativamente con la ordenación.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitVar &lt;-<span class="st"> </span><span class="kw">envfit</span>(ord.cca, dune.env)
fitVar</code></pre></div>
<pre><code>## 
## ***VECTORS
## 
##         CCA1      CCA2     r2 Pr(&gt;r)  
## A1  0.996690 -0.081278 0.4812  0.011 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## Permutation: free
## Number of permutations: 999
## 
## ***FACTORS:
## 
## Centroids:
##                 CCA1    CCA2
## Moisture1    -0.7841  0.1023
## Moisture2    -0.7047 -0.3941
## Moisture4    -0.0690 -1.1244
## Moisture5     1.4052  0.5459
## ManagementBF -0.8428  0.0317
## ManagementHF -0.3461 -0.1831
## ManagementNM  0.9747  2.0835
## ManagementSF  0.1233 -1.3692
## UseHayfield  -0.3809  1.2869
## UseHaypastu  -0.1953 -1.0131
## UsePasture    0.8511 -0.0640
## Manure0       0.9747  2.0835
## Manure1      -0.5822  0.0043
## Manure2      -0.5826 -0.3399
## Manure3       0.6233 -0.6456
## Manure4      -0.7009 -1.5898
## 
## Goodness of fit:
##                r2 Pr(&gt;r)    
## Moisture   0.3176  0.035 *  
## Management 0.4941  0.001 ***
## Use        0.3204  0.005 ** 
## Manure     0.5105  0.001 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## Permutation: free
## Number of permutations: 999</code></pre>
<p>Podemos utilizar el <em>Goodness of fit</em> para ver cuáles son las variables que ajustan la ordenación y utilizar estas para hacer el modelo constreñido. En este caso utilizaremos Manure y Management.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ord.ccafit &lt;-<span class="st"> </span><span class="kw">cca</span>(dune~Manure+Management, <span class="dt">data=</span>dune.env)
ord.ccafit</code></pre></div>
<pre><code>## Call: cca(formula = dune ~ Manure + Management, data = dune.env)
## 
##               Inertia Proportion Rank
## Total          2.1153     1.0000     
## Constrained    0.8766     0.4144    6
## Unconstrained  1.2386     0.5856   13
## Inertia is scaled Chi-square 
## Some constraints were aliased because they were collinear (redundant)
## 
## Eigenvalues for constrained axes:
##   CCA1   CCA2   CCA3   CCA4   CCA5   CCA6 
## 0.3617 0.2271 0.1454 0.0655 0.0418 0.0353 
## 
## Eigenvalues for unconstrained axes:
##    CA1    CA2    CA3    CA4    CA5    CA6    CA7    CA8    CA9   CA10 
## 0.4082 0.1592 0.1493 0.1252 0.0962 0.0774 0.0649 0.0424 0.0382 0.0312 
##   CA11   CA12   CA13 
## 0.0251 0.0121 0.0090</code></pre>
<p>Como vemos con este procedimiento subimos al 41% de la varianza explicada.</p>
<p>Podemos utilizar la función anova para evaluar la significancia de cada variable dentro del modelo, de forma separada.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ord.ccaT &lt;-<span class="st"> </span><span class="kw">cca</span>(dune~<span class="st"> </span>., <span class="dt">data=</span>dune.env)
<span class="kw">anova</span>(ord.ccaT, <span class="dt">by=</span><span class="st">&quot;term&quot;</span>, <span class="dt">permu=</span><span class="dv">1000</span>)</code></pre></div>
<pre><code>## Permutation test for cca under reduced model
## Terms added sequentially (first to last)
## Permutation: free
## Number of permutations: 999
## 
## Model: cca(formula = dune ~ A1 + Moisture + Management + Use + Manure, data = dune.env)
##            Df ChiSquare      F Pr(&gt;F)  
## A1          1   0.22476 2.5704  0.014 *
## Moisture    3   0.51898 1.9783  0.014 *
## Management  3   0.39543 1.5074  0.072 .
## Use         2   0.10910 0.6238  0.926  
## Manure      3   0.25490 0.9717  0.528  
## Residual    7   0.61210                
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Como vemos esto cambia lo que inicialmente habíamos decidido, esto es debido a que algunas de las variables pueden estar correlacionadas entre ellas.</p>
<p>Bien ahora necesitamos graficar los resultados. Podemos utilizar la función plot e ir graficando cada uno de los componentes (Figura <a href="graficar-los-resultados.html#fig:plotcca">3.2</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(ord.cca, <span class="dt">dis=</span><span class="st">&quot;sp&quot;</span>, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>)
<span class="kw">points</span>(ord.cca, <span class="dt">dis=</span><span class="st">&quot;sites&quot;</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>)
<span class="kw">points</span>(ord.cca, <span class="dt">display=</span><span class="st">&quot;cn&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">pch=</span><span class="dv">19</span>)
<span class="kw">text</span>(ord.cca, <span class="dt">dis=</span><span class="st">&quot;sp&quot;</span>, <span class="dt">cex=</span><span class="fl">0.6</span>)
<span class="kw">text</span>(ord.cca, <span class="dt">display =</span> <span class="st">&quot;cn&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">cex=</span><span class="fl">0.7</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plotcca"></span>
<img src="AnalisisMultivarianteComunidad_files/figure-html/plotcca-1.png" alt="Representación gráfica del CCA" width="432" />
<p class="caption">
Figure 3.2: Representación gráfica del CCA
</p>
</div>
<p>Muchas veces uno de los problemas que tenemos para graficar los datos es que los nombres de las especies son muy largos, en estos casos podemos utilizar una función que se denomina <code>make.cepnames</code> la cual permite acortar los nombres.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(BCI)
<span class="kw">names</span>(BCI[<span class="dv">1</span>:<span class="dv">5</span>])</code></pre></div>
<pre><code>## [1] &quot;Abarema.macradenia&quot;    &quot;Vachellia.melanoceras&quot; &quot;Acalypha.diversifolia&quot;
## [4] &quot;Acalypha.macrostachya&quot; &quot;Adelia.triloba&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">short &lt;-<span class="st"> </span><span class="kw">make.cepnames</span>(<span class="kw">names</span>(BCI[<span class="dv">1</span>:<span class="dv">5</span>]))
short</code></pre></div>
<pre><code>## [1] &quot;Abarmacr&quot; &quot;Vachmela&quot; &quot;Acaldive&quot; &quot;Acalmacr&quot; &quot;Adeltril&quot;</code></pre>
<p>Existen procedimientos para construir modelos que ahora no tocaremos, puede encontrar más información en <a href="http://cc.oulu.fi/~jarioksa/opetus/metodi/vegantutor.pdf">Oksanen 2015</a></p>
<p>Nota: para realizar un permanova debemos utilizar la función adonis. El procedimiento es similar al desarrollo del cca.</p>
</div>
<div id="ejercicio-3-analisis-de-ordenacion" class="section level2">
<h2><span class="header-section-number">3.3</span> Ejercicio 3: Análisis de Ordenación</h2>
<p>Con los datos utilizados para realizar el análisis de aglomerados, vamos a realizar un análisis de ordenación constreñida.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Defina que tipo de ordenación constreñida debe realizar para explicar la variación de los datos de herbáceas.</p></li>
<li><p>Realice un análisis para definir las variables que se debería utilizar en el análisis</p></li>
<li><p>Ajuste un modelo y defina el porcentaje de variación explicado.</p></li>
<li><p>Compara los resultados de la ordenación directa si en vez de transformar los datos corremos los modelos con los datos brutos.</p></li>
<li><p>Realice un gráfico del modelo desarrollado.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ordenaciones.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bibliografia.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-OrdIndirectas.Rmd",
"text": "Edit"
},
"download": ["AnalisisMultivarianteComunidad.pdf", "AnalisisMultivarianteComunidad.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
